<div class="ui-g ui-fluid">
    <div class="ui-g-12">
        <p-breadcrumb [model]="breadcrumbItems"></p-breadcrumb>
    </div>
    <div class="ui-g-12 ui-lg-12">
        <ng-container *ngIf="!rerender">
            <p-panel class="" header="Select a Requests to process">
                <div class="card card-w-title">
                    <p-table #ttAddAssignment [columns]="cols" [value]="requests" selectionMode="single" [(selection)]="selectedRequest"
                        sortField="id" sortOrder="-1" [resizableColumns]="true" [scrollable]="true" scrollHeight="650px"
                        [responsive]="true">

                        <ng-template pTemplate="colgroup" let-columns>
                            <colgroup>
                                <col *ngFor="let col of columns">
                            </colgroup>
                        </ng-template>

                        <ng-template pTemplate="caption">
                            <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                            <input type="text" pInputText size="40" placeholder="Global Filter" (input)="ttAddAssignment.filterGlobal($event.target.value, 'contains')"
                                style="width:50%">
                        </ng-template>

                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of cols" [pSortableColumn]="col.field" pResizableColumn>
                                    {{col.header}}
                                    <p-sortIcon [field]="col.field"></p-sortIcon>
                                </th>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-columns="columns">
                            <tr [pSelectableRow]="rowData">
                                <td *ngFor="let col of columns" class="ui-resizable-column">
                                    {{rowData[col.field]}}
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="footer" let-columns>
                            <tr>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            {{requests?.length}} requests in the Customer Service Manager queue
                        </ng-template>
                        <ng-template pTemplate="emptymessage" let-columns>
                            <tr>
                                <td [attr.colspan]="columns.length">
                                    No records found
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>

                <div class="">
                    <button pButton type="button" (click)="sendToFinancialManager()" label="Sent to FM" icon="fa fa-paper-plane" style="margin-bottom:0px; margin-right:10px"
                        class="btn-size-long ui-button-success" [disabled]="!selectedRequest"></button>

                    <button pButton (click)="showDeleteDialog()" type="button" label="Delete" icon="fa fa-times" style="margin-bottom:0px"
                        class="btn-size-short ui-button-danger" [disabled]="!selectedRequest"></button>
                </div>
                
                </div>
            </p-panel>

        </ng-container>
    </div>

    <!-- Events list -->
    <div class="ui-g-12 ui-lg-12">
        <ng-container *ngIf="!rerender">
            <p-panel class="" header="Select an Event to process">
                <div class="card card-w-title">
                    <p-table #ttEvent [columns]="colsEvent" [value]="myEvents" selectionMode="single" [(selection)]="selectedEvent"
                        sortField="id" sortOrder="-1" [resizableColumns]="true" [scrollable]="true" scrollHeight="650px"
                        [responsive]="true">

                        <ng-template pTemplate="colgroup" let-columns>
                            <colgroup>
                                <col *ngFor="let col of columns">
                            </colgroup>
                        </ng-template>

                        <ng-template pTemplate="caption">
                            <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                            <input type="text" pInputText size="40" placeholder="Global Filter" (input)="ttEvent.filterGlobal($event.target.value, 'contains')"
                                style="width:50%">
                        </ng-template>

                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of colsEvent" [pSortableColumn]="col.field" pResizableColumn>
                                    {{col.header}}
                                    <p-sortIcon [field]="col.field"></p-sortIcon>
                                </th>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-columns="columns">
                            <tr [pSelectableRow]="rowData">
                                <td *ngFor="let col of columns" class="ui-resizable-column">
                                    {{rowData[col.field]}}
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="footer" let-columns>
                            <tr>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            {{myEvents?.length}} Events in the Customer Service Manager queue
                        </ng-template>
                        <ng-template pTemplate="emptymessage" let-columns>
                            <tr>
                                <td [attr.colspan]="columns.length">
                                    No records found
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>

                    <div class="">
                        <button pButton type="button" (click)="planWithClient()" label="Plan with client" icon="fa fa-paper-plane"
                            style="margin-bottom:0px; margin-right:10px" class="btn-size-long " [disabled]="!selectedEvent"></button>

                        <button pButton (click)="sendEventToProd()" type="button" label="Send to Prod" icon="fa fa-paper-plane" style="margin-bottom:0px"
                            class="btn-size-long ui-button-success" [disabled]="!selectedEvent"></button>
                    </div>

                </div>
            </p-panel>

        </ng-container>
    </div>

</div>

<p-dialog header="Confirm Delete" [modal]="true" [(visible)]="displayDeleteDialog" >
    Are you sure? THIS CANNOT BE UNDONE!
    <p-footer>
        <button pButton label="Cancel" icon="fa fa-times" (click)="initBooleans()"
            class="ui-button-secondary"></button>
        <button pButton label="Delete Request" icon="fa fa-check" (click)="deleteRequest()" class="ui-button-danger"></button>
    </p-footer>
</p-dialog>

<p-dialog header="Send Event to Production" [modal]="true" [(visible)]="displayEventDialog" >
    SENDING TO ALL PROD MANAGERS... Are you sure?
    <p-footer>
        <button pButton label="Cancel" icon="fa fa-times" (click)="initBooleans()"
            class="ui-button-secondary"></button>
        <button pButton label="Send Event" icon="fa fa-check" (click)="sendEventToProd()" class="ui-button-danger"></button>
    </p-footer>
</p-dialog>

<p-growl [value]="messages" [immutable]="false" life="2000"></p-growl>

