<div class="ui-g ui-fluid">
    <div class="ui-g-12">
        <p-breadcrumb [model]="breadcrumbItems"></p-breadcrumb>
    </div>
    <div class="ui-g-12 ui-lg-12">
        <ng-container *ngIf="!rerender">
            <p-panel class="" header="Select a Requests to process">
                <div class="card card-w-title">
                    <p-table #ttAddAssignment [columns]="cols" [value]="requests" selectionMode="single" [(selection)]="selectedRequest"
                        sortField="recordNumber" sortOrder="1" [resizableColumns]="true" [scrollable]="true"
                        scrollHeight="650px" [responsive]="true">

                        <ng-template pTemplate="colgroup" let-columns>
                            <colgroup>
                                <col *ngFor="let col of columns">
                            </colgroup>
                        </ng-template>

                        <ng-template pTemplate="caption">
                            <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                            <input type="text" pInputText size="40" placeholder="Global Filter" (input)="ttAddAssignment.filterGlobal($event.target.value, 'contains')"
                                style="width:50%">
                        </ng-template>

                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of cols" [pSortableColumn]="col.field" pResizableColumn>
                                    {{col.header}}
                                    <p-sortIcon [field]="col.field"></p-sortIcon>
                                </th>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-columns="columns">
                            <tr [pSelectableRow]="rowData">
                                <td *ngFor="let col of columns" class="ui-resizable-column">
                                    {{rowData[col.field]}}
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="footer" let-columns>
                            <tr>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="summary">
                            {{requests?.length}} requests in the Customer Service Manager queue
                        </ng-template>
                        <ng-template pTemplate="emptymessage" let-columns>
                            <tr>
                                <td [attr.colspan]="columns.length">
                                    No records found
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>

                    <div class="">
                        <!-- <button pButton type="button" (click)="sendBackToCSManager()" label="Sent to CSM & Create Event" icon="fa fa-paper-plane" -->
                        <button pButton type="button" (click)="showCreateEventDialog()" label="Sent to CSM & Create Event" icon="fa fa-paper-plane"
                            style="margin-bottom:0px; margin-right:10px" class="btn-size-long ui-button-success"
                            [disabled]="!selectedRequest"></button>

                        <button pButton (click)="rejectRequest()" type="button" label="Reject-Back to FM" icon="fa fa-times"
                            style="margin-bottom:0px" class="btn-size-long ui-button-danger" [disabled]="!selectedRequest"></button>
                    </div>

                    <form class="card card-w-title" [formGroup]="eventForm">

                    </form>

                </div>
            </p-panel>

        </ng-container>
    </div>

</div>

<p-dialog header="Create Event" [modal]="true" [(visible)]="displayCreateEventDialog" size="350">

    <form class="card card-w-title" [formGroup]="eventForm">

        <fieldset>
            <legend> (<i class="fa fa-asterisk" aria-hidden="true"></i> = Mandatory Fields)</legend>
                    
<div>
    &nbsp;&nbsp;
</div>

<div class="">
    <i class="fa fa-asterisk" aria-hidden="true"></i><i class="fa fa-search"></i>&nbsp;
    <label for="">Signed By </label>
    <div class="">
        <p-autoComplete id="" formControlName="signedBy" [suggestions]="filteredUsers" (completeMethod)="getFilteredUsers($event)"
            [size]="40" (onSelect)="getUserId()" [minLength]="1" placeholder="Search... username/dept." [dropdown]="false"
            field="username">
            <ng-template let-user pTemplate="item">
                <div class="ui-helper-clearfix">
                    <div style="font-size:12px;float:right;margin:10px 10px 0 0">
                        {{user.username}} | {{user.type}} | {{user.department}}
                    </div>
                </div>
            </ng-template>
        </p-autoComplete>
    </div>
</div>

<div>
    &nbsp;&nbsp;
</div>

<div class="">
    <i class="fa fa-asterisk" aria-hidden="true"></i><i class="fa fa-search"></i>&nbsp;
    <label for="">Client </label>
    <div class="">
        <p-autoComplete id="" formControlName="client" [suggestions]="filteredClients" (completeMethod)="getFiltereClients($event)"
            [size]="40" (onSelect)="getClientId()" [minLength]="1" placeholder="Search... name/email." [dropdown]="false"
            field="name">
            <ng-template let-client pTemplate="item">
                <div class="ui-helper-clearfix">
                    <div style="font-size:12px;float:right;margin:10px 10px 0 0">
                        {{client.name}} | {{client.phone}} | {{client.email}}
                    </div>
                </div>
            </ng-template>
        </p-autoComplete>
    </div>
</div>

<div class="">
    <button pButton type="button" label="Save & Sent to CSM" icon="fa fa-floppy-o" style="margin-bottom:0px; margin-right:10px"
        class="btn-size-long ui-button-success" [disabled]="hasFormsErrors()" (click)="createEventFromRequest()"></button>

    <button pButton (click)="initBooleans()" type="button" label="Cancel" icon="fa fa-times" style="margin-bottom:0px"
        class="btn-size-short "></button>
</div>



        </fieldset>
    </form>



</p-dialog>




<p-growl [value]="messages" [immutable]="false" life="2000"></p-growl>
